{% extends 'inicio/encabezado.html' %}
{% block contenido %}
<style>
    .casa-detalle-container {
        max-width: 850px;
        margin: 40px auto;
        background-color: #fdfdfd;
        padding: 35px;
        border-radius: 20px;
        box-shadow: 0 12px 30px rgba(0,0,0,0.08);
        text-align: center;
    }

    .casa-detalle-container img {
        max-width: 100%;
        height: auto;
        border-radius: 15px;
        margin-bottom: 25px;
        object-fit: cover;
    }

    .casa-detalle-container h2 {
        color: #1e874b;
        margin-bottom: 25px;
        font-size: 2rem;
        font-weight: 600;
    }

    .casa-info p {
        font-size: 1rem;
        margin-bottom: 8px;
        color: #555;
    }

    .opinion-card {
        background-color: #f8f9fa;
        padding: 18px;
        margin: 15px auto;
        border-radius: 12px;
        max-width: 700px;
        text-align: left;
        box-shadow: 0 6px 18px rgba(0,0,0,0.05);
        transition: transform 0.2s;
    }

    .opinion-card:hover {
        transform: translateY(-3px);
    }

    .opinion-header {
        display: flex;
        justify-content: space-between;
        font-weight: 500;
        color: #333;
        margin-bottom: 8px;
    }

    .opinion-message {
        font-size: 0.95rem;
        color: #444;
    }

    .btn-volver {
        display: inline-block;
        margin-top: 25px;
        background-color: #1e874b;
        color: white;
        padding: 10px 22px;
        border-radius: 10px;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s;
    }

    .btn-volver:hover {
        background-color: #166438;
        transform: scale(1.05);
    }

    form textarea {
        width: 100%;
        border-radius: 10px;
        padding: 12px;
        border: 1px solid #ccc;
        resize: vertical;
    }

    .btn-success {
        font-weight: 500;
        padding: 10px 20px;
        border-radius: 8px;
    }
</style>

<div class="casa-detalle-container">
    <h2>{{ casa.titulo }}</h2>
    {% if casa.imagen %}
        <img src="{{ casa.imagen.url }}" alt="{{ casa.titulo }}">
    {% endif %}

    <div class="casa-info">
        <p><strong>Precio:</strong> ${{ casa.precio }}</p>
        <p><strong>Dirección:</strong> {{ casa.direccion }}, {{ casa.ciudad }}</p>
        <p><strong>Habitaciones:</strong> {{ casa.habitaciones }}</p>
        <p><strong>Baños:</strong> {{ casa.banos }}</p>
        <p><strong>Metros cuadrados:</strong> {{ casa.metros_cuadrados }}</p>
        <p><strong>Descripción:</strong> {{ casa.descripcion }}</p>
    </div>

    <hr>

    <h4>Opiniones</h4>
    {% for opinion in opiniones %}
    <div class="opinion-card">
        <div class="opinion-header">
            <span>{{ opinion.usuario.username }}</span>
            <span>{{ opinion.fecha_creacion|date:"d/m/Y H:i" }}</span>
        </div>
        <p class="opinion-message">{{ opinion.mensaje }}</p>
    </div>
    {% empty %}
        <p class="text-muted">No hay opiniones todavía.</p>
    {% endfor %}

    <hr>

    {% if user.is_authenticated %}
    <h5>Escribir una opinión</h5>
    <form method="post">
        {% csrf_token %}
        {{ form.mensaje }}
        <button type="submit" class="btn btn-success mt-2"><i class="fas fa-comment"></i> Enviar opinión</button>
    </form>
    {% else %}
        <p class="text-center">Debes <a href="{% url 'login' %}">iniciar sesión</a> para dejar una opinión.</p>
    {% endif %}

</div>
{% endblock %}
